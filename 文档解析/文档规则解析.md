---
sort: 1
---

# æ–‡æ¡£è§„åˆ™è§£æ

> æŒç»­æ›´æ–°ä¸­


[ğŸ”¨ç®—æ³•å¼€å‘æ‰‹å†Œ](https://kg-nlp.github.io/Algorithm-Project-Manual/æ–‡æ¡£è§£æ/æ–‡æ¡£è§„åˆ™è§£æ.html)


[ğŸ”¨ä¸ªäººçŸ¥ä¹](https://www.zhihu.com/people/zhangyj-n)

* è§£å†³é—®é¢˜

    * åŸºäºpythonçš„æ–‡ä»¶è§£å‹,è½¬æ¢æ“ä½œ,ä»¥åŠæ·»åŠ è§„åˆ™è§£ææ–‡æ¡£è‡³txt
    * å·²ç»å®Œæˆçš„å·¥ä½œ

|åŠŸèƒ½|
|---|
|è§£å‹tar|
|è§£å‹rar|
|è§£å‹7z|
|è§£å‹gz|
|è§£å‹zip|
|xlsè½¬xlsx|
|docè½¬docx|
|pdfè½¬docx|
|docxè½¬txt|



## ç¯å¢ƒ

```python
import zipfile
import gzip
import tarfile
import rarfile
import docx
import cn2an
import re
import os
import pandas as pd
import pyexcel
import shutil
import time
from pdf2docx import Converter
from win32com import client as wc
from py7zr import unpack_7zarchive
from collections import defaultdict
from core import custom
```

## å¤„ç†taræ–‡ä»¶,è§£å‹å•ä¸ªæ–‡ä»¶

```python
def untar(filename,old_dir='',new_dir=''):
    '''old_dir,new_diréœ€è¦æŒ‡å®š'''
    file_dir = filename.replace('.tar','').replace(old_dir,new_dir)
    is_dir(file_dir)
    tar = tarfile.open(filename)
    names = tar.getnames()
    for name in names:
        tar.extract(name,file_dir)
    tar.close()
    time.sleep(1)
    os.remove(filename)
    return file_dir
```

## å¤„ç†zipæ–‡ä»¶,è§£å‹å•ä¸ªæ–‡ä»¶

```python
def unzip(filename,old_dir='',new_dir=''):
    file_dir = filename.replace('.zip','').replace(old_dir,new_dir)
    is_dir(file_dir)
    zf = zipfile.ZipFile(filename)
    for name in zf.namelist():
        zf.extract(name,file_dir)
    zf.close()
    time.sleep(1)
    os.remove(filename)
    return file_dir
```

## å¤„ç†raræ–‡ä»¶,è§£å‹å•ä¸ªæ–‡ä»¶

```python
def unrar(filename,old_dir='',new_dir=''):
    '''æœ‰bug,windowsä¸‹ç¼ºè½¯ä»¶'''
    file_dir = filename.replace('.rar','').replace(old_dir,new_dir)
    is_dir(file_dir)
    rar = rarfile.RarFile(filename)
    for name in rar.namelist():
        rar.extract(name,file_dir)
        return
    rar.close()
    time.sleep(1)
    os.remove(filename)
    return file_dir
```

## å¤„ç†7zæ–‡ä»¶,è§£å‹å•ä¸ªæ–‡ä»¶

```python
def un7zip(filename,old_dir='',new_dir=''):
    ''''''
    file_dir = filename.replace('.7z','').replace(old_dir,new_dir)
    shutil.register_unpack_format('7zip', ['.7z'], unpack_7zarchive)
    shutil.unpack_archive(filename, file_dir)
    time.sleep(1)
    os.remove(filename)
    return file_dir
```

## å¤„ç†gzæ–‡ä»¶,è§£å‹å•ä¸ªæ–‡ä»¶

```python
def ungz(filename,old_dir='',new_dir=''):
    filename = filename[:-3]  # gzæ–‡ä»¶çš„å•æ–‡ä»¶è§£å‹å°±æ˜¯å»æ‰ filename åé¢çš„ .gz
    file_dir = filename.replace(old_dir,new_dir)
    gz_file = gzip.GzipFile(filename)
    with open(file_dir, "w+") as file:
        file.write(gz_file.read())
        os.remove(filename)
        return file_dir
```

## ä¸åŒæ ¼å¼è¯»å–txtæ–‡æ¡£


```python
def read_txt(file):
    try:
        with open(file, 'r', encoding='gbk') as f:
            file_str = f.read()
    except:
        try:
            with open(file, 'r', encoding='utf-8') as f:
                file_str = f.read()
        except:
            try:
                with open(file, 'r', encoding='gb2312') as f:
                    file_str = f.read()
            except:
                try:
                    with open(file, 'r', encoding='gb18030') as f:
                        file_str = f.read()
                except:
                    try:
                        with open(file, 'r', encoding='big5') as f:
                            file_str = f.read()
                    except:
                        try:
                            with open(file, 'r', encoding='cp936') as f:
                                file_str = f.read()
                        except:
                            file_str = ''
                            print(file)
    return file_str
```

## docè½¬docx åœ¨windowsç¯å¢ƒä¸‹æ“ä½œ

```python
def doc2docx(filename):
    '''åœ¨windowsä¸‹è¿›è¡Œæ“ä½œ  éœ€è¦æ–‡ä»¶çš„ç»å¯¹è·¯å¾„'''
    # pip install pypiwin32
    # å°†æ‰€æœ‰çš„docéƒ½æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œ,ç»Ÿä¸€åˆ°windowsä¸‹è½¬æ¢
    new_name = filename.replace('.doc', '_è½¬.docx')
    if os.path.exists(new_name):
        return
    new_name = filename.replace('.doc', 'doc_è½¬.docx')
    if os.path.exists(new_name):
        return
    word = wc.Dispatch("Word.Application")
    doc = word.Documents.Open(filename)  # æ‰“å¼€wordæ–‡ä»¶
    doc.SaveAs(filename.replace('.doc','doc_è½¬.docx'), 12)  # å¦å­˜ä¸ºåç¼€ä¸º".docx"çš„æ–‡ä»¶ï¼Œå…¶ä¸­å‚æ•°12æŒ‡docxæ–‡ä»¶
    doc.Close()  # å…³é—­åŸæ¥wordæ–‡ä»¶
    word.Quit()
    time.sleep(1)
    os.remove(filename)
```
## linuxä¸‹docè½¬docx

```python
# 1ã€å…ˆåœ¨linuxç³»ç»Ÿå®‰è£…antiword
apt-get install antiword
# 2ã€æ‰§è¡Œä»£ç ï¼ˆåªé€‚åˆdocæ ¼å¼ï¼Œdocxè²Œä¼¼ä¸è¡Œï¼‰
def get_doc_text(filename):
    doc = subprocess.check_output(['antiword',inputfilename]).decode('utf-8')
    return doc
```

## xlsè½¬xlsx


```python
def xls2xlsx(filename,old_dir='',new_dir=''):
    new_name = filename.replace('.pdf', '_è½¬.xlsx')
    if os.path.exists(new_name):
        return
    new_name = filename.replace('.pdf', 'xls_è½¬.xlsx')
    if os.path.exists(new_name):
        return
    new_file_name = filename.replace(old_dir,new_dir).replace('.xls','xls_è½¬.xlsx')
    pyexcel.save_book_as(file_name=filename,
                         dest_file_name=new_file_name)
    time.sleep(1)
    os.remove(filename)
```

## pdfè½¬docx


```python
def pdf2docx(filename,old_dir='',new_dir=''):
    ''''''
    cv = Converter(filename)
    new_name = filename.replace('.pdf','_è½¬.docx')
    if os.path.exists(new_name):
        return
    new_name = filename.replace('.pdf','pdf_è½¬.docx')
    if os.path.exists(new_name):
        return
    cv.convert(filename.replace('.pdf','pdf_è½¬.docx'))
    cv.close()
    time.sleep(1)
    os.remove(filename)
```

## ç»Ÿä¸€è§£å‹æ–‡ä»¶,ç”Ÿæˆæ–°ç›®å½•


```python
def unzip_files(filename,old_dir='',new_dir=''):
    '''
    return True:æ˜¯å‹ç¼©åŒ…ï¼Œè¿”å›æ–°ç›®å½•
    return False:éå‹ç¼©åŒ…ï¼Œæ–‡ä»¶æˆ–ç›®å½•
    '''
    file_dir = ''
    if '.' in filename:
        suffix = filename.split('.')[-1].lower()
        if suffix == 'gz':
            new_filename = ungz(filename,old_dir,new_dir)
            if new_filename.split('.')[-1] == 'tar':
                file_dir = untar(new_filename,old_dir,new_dir)
        elif suffix == 'tar':
            file_dir = untar(filename,old_dir,new_dir)
        elif suffix == 'zip':
            file_dir = unzip(filename,old_dir,new_dir)
        elif suffix == '7z':
            file_dir = un7zip(filename,old_dir,new_dir)
        # elif suffix == 'rar':
        #     unrar(filename,old_dir,new_dir)
        #     return True
    return file_dir
```

## ç»Ÿä¸€è¯»å–æ–‡ä»¶è½¬ä¸ºdocx,è½¬excel


```python
def parse_file(filename):
    # print('filename',filename)
    if '.' in filename:
        suffix = filename.split('.')[-1].lower()
        if suffix == 'pdf':
            pdf2docx(filename)
        elif suffix == 'doc':
            doc2docx(filename)
        elif suffix == 'xls':
            xls2xlsx(filename)
        elif suffix == 'docx':
            if '~' in filename:
                os.remove(filename)
        elif suffix in ['xlsx','txt']:
            pass
        else:
            print('éè§£ææ–‡ä»¶',filename)
```

## åˆ¤æ–­æ˜¯å‹ç¼©æ–‡ä»¶æˆ–ç›®å½•


```python
def judge_zip_dir(dir_list):
    flag = False  # è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹æ²¡æœ‰å‹ç¼©æ–‡ä»¶æ²¡æœ‰ç›®å½•
    for filename in dir_list:
        if os.path.isdir(filename):
            flag = True
            break
        if '.' in filename :
            suffix = filename.split('.')[-1].lower()
            if suffix in ['zip', 'tar', 'gz', '7z'] :
                flag = True  # è¯´æ˜æœ‰å‹ç¼©æ–‡ä»¶
                break
    return flag
```

## åˆ¤æ–­æ˜¯å¦åŒ…å«doc,pdf,xlsæ–‡ä»¶(è¯¥ç›®å½•ä¸‹æ²¡æœ‰ä»»ä½•ç›®å½•å’Œå‹ç¼©åŒ…)


```python
def judge_no_format(dir_list):
    flag = False  # è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹æ²¡æœ‰doc,pdf,xlså’Œç›®å½•,æœ‰çš„è¯éœ€è¦è¿›è¡Œè½¬æ¢,æˆ–åˆ°ç›®å½•é‡Œç»§ç»­æŸ¥çœ‹
    for filename in dir_list:
        if os.path.isdir(filename):
            flag = True
            break
        if '.' in filename:
            suffix = filename.split('.')[-1].lower()
            if suffix in ['doc', 'pdf', 'xls']:
                flag = True  # è¯´æ˜æœ‰å¾…è§£æçš„æ–‡ä»¶
                break
    return flag
```

## éå†æ ¹ç›®å½•ï¼Œè§£å‹å‡ºæ–°ç›®å½•


```python
def traversal_dir(path_dir):

    # path_dir ä¸ºå½“å‰ç›®å½•ï¼ˆéœ€è¦åˆ¤æ–­ç›®å½•ä¸‹æœ‰æ²¡æœ‰å‹ç¼©æ–‡ä»¶å’Œç›®å½•ï¼Œæ²¡æœ‰åˆ™å¯ä»¥è¿”å›ï¼‰ï¼Œå‹ç¼©æ–‡ä»¶ï¼Œéå‹ç¼©æ–‡ä»¶ï¼Œç›®å½•ï¼›å½“ä¸€ä¸ªç›®å½•ä¸‹å…¨æ˜¯éå‹ç¼©æ–‡ä»¶åˆ™è¿”å›
    dir_list = [os.path.join(path_dir, i) for i in os.listdir(path_dir)]
    if not judge_zip_dir(dir_list):  # æ—¢ä¸æ˜¯å‹ç¼©æ–‡ä»¶ä¹Ÿä¸æ˜¯ç›®å½•
        return
    for dir_or_file in dir_list:
        # æ˜¯æ–‡ä»¶å†åˆ¤æ–­æ˜¯å¦è§£å‹
        try:
            if os.path.isfile(dir_or_file):
                file_dir = unzip_files(dir_or_file)
                if file_dir: traversal_dir(file_dir)
                # else:parse_file(dir_or_file)
            # æ˜¯ç›®å½•åˆ™å¼€å§‹éå†ç›®å½•
            elif os.path.isdir(dir_or_file):
                # print('ç›®å½•', dir_or_file)
                traversal_dir(dir_or_file)
        except:
            print(dir_or_file)
            continue
```

## éå†ç›®å½•,æ•°æ®è½¬æ¢


```python
def traversal_file(path_dir):
    dir_list = [os.path.join(path_dir, i) for i in os.listdir(path_dir)]
    if not judge_no_format(dir_list):
        return
    for dir_or_file in dir_list:
        try:
            if os.path.isdir(dir_or_file):
                traversal_file(dir_or_file)
            elif os.path.isfile(dir_or_file):
                parse_file(dir_or_file)
        except:
            print(dir_or_file)
            continue
```

## è¯»å–docxæ–‡ä»¶


```python
def read_docx(filename,old_dir='',new_dir=''):
    '''
    :param filename: txtæˆ–excelæ–‡ä»¶
    :param old_dir:  æ—§å…³é”®ç›®å½•
    :param new_dir:  æ–°å…³é”®ç›®å½•(é»˜è®¤å·²ç»åˆ›å»ºäº†æ–°ç›®å½•)
    :return: excel
    '''
    # è½¬æˆexcel,å¦‚æœæ ¼å¼å†…å®¹å¾ˆå°‘,åˆ™è½¬ä¸ºtxt,éƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„
    # é»˜è®¤æ–°è·¯å¾„å·²ç»åˆ›å»º
    file_dir = filename.replace(old_dir,new_dir)
    total_list = []
    columns_list = ['åˆåŒ','æ®µè½/æ ‡é¢˜','para/title','ç²—ä½“','ä¸‹åˆ’çº¿','æ–œä½“']
    def _paragraph_analysis(paragraphs_infos, table_flag):
        paragraph_nums = len(paragraphs_infos)  # æ®µè½æ•°
        for i in range(paragraph_nums):  # æ®µè½ç´¢å¼•
            single_paragraph = paragraphs_infos[i]
            paragraph_or_title = custom.format_text(single_paragraph.text)
            if not paragraph_or_title:  # é˜²æ­¢ä¸ºç©ºï¼Œè¿‡æ»¤
                continue
            # æ®µè½/æ ‡é¢˜
            # åˆ¤æ–­æ˜¯å¦æ˜¯ä¸»æ ‡é¢˜
            if ('Heading' in str(single_paragraph.style) or 'Subtitle' in str(single_paragraph.style)) and not table_flag:  # éè¡¨æ ¼çš„æ—¶å€™éœ€è¦åˆ¤æ–­æ ‡é¢˜
                p_t_flag = 'title'
            else:
                p_t_flag = 'para'
            # æå–ç²—ä½“ã€ä¸‹åˆ’çº¿ã€æ–œä½“
            single_all_runs = single_paragraph.runs  # æ¯ä¸ªæ®µè½æ‰€æœ‰å¯¹è±¡
            bold_list = []
            underline_list = []
            italic_list = []
            for j in range(len(single_all_runs)):  # å¯¹è±¡ç´¢å¼•
                single_run = single_all_runs[j]
                single_run_text = custom.format_text(single_run.text)
                if single_run.bold:
                    # print(single_paragraph.text, single_all_runs[j].text, '--', 'bold', single_all_runs[j].bold)  # æ˜¯å¦ç²—ä½“
                    if single_run_text:
                        bold_list.append(single_run_text)
                if single_run.underline:
                    # print(single_paragraph.text, single_all_runs[j].text, '--', 'underline', single_all_runs[j].underline)  # æ˜¯å¦å¸¦ä¸‹åˆ’çº¿
                    if single_run.text:
                        underline_list.append(single_run.text)
                if single_run.italic:
                    # print(single_paragraph.text, single_all_runs[j].text, '--', 'italic', single_all_runs[j].italic)  # æ˜¯å¦æ–œä½“
                    if single_run.text:
                        italic_list.append(single_run.text)
            total_list.append([filename[:-5],paragraph_or_title,p_t_flag,bold_list,underline_list,italic_list])

    doc = docx.Document(filename)
    # è¯»å–æ®µè½ä¿¡æ¯
    all_paragraphs = doc.paragraphs  # æ‰€æœ‰æ®µè½
    _paragraph_analysis(all_paragraphs, False)

    # åˆ—è¡¨å¯èƒ½åµŒå¥—ï¼Œåé¢å†è¯¦ç»†å†™
    all_tables = doc.tables
    if all_tables:
        for row in all_tables[0].rows:  # æŒ‰è¡Œè¯»å–
            for cell in row.cells:  # è¯»å–æ¯ä¸ªå•å…ƒæ ¼æ•°æ®
                single_cell_paragraphs = cell.paragraphs  # æ¯ä¸ªå•å…ƒæ ¼å¯»æ‰¾æ®µè½
                _paragraph_analysis(single_cell_paragraphs, True)

    df = pd.DataFrame(total_list, columns=columns_list)
    df = df.rename_axis('å…¨å±€ç´¢å¼•').reset_index()
    df.to_excel(file_dir.replace('.docx','.xlsx'), index=0)
    # os.remove(filename)

```

## ä»docxä¸­æå–è¡¨æ ¼
```python
'''docxè½¬pdfå†è½¬docx,æœ€åæŠ½å–è¡¨æ ¼'''
def docx_pdf(filename):

    try:
        doc = docx.Document(filename)
        all_tables_list = doc.tables
        # print(all_tables_list)
        if all_tables_list:
            for ind, all_table in enumerate(all_tables_list):
                table_list = []
                for row in all_table.rows:  # æŒ‰è¡Œè¯»å–
                    row_content = []
                    for cell in row.cells:  # è¯»å–æ¯ä¸ªå•å…ƒæ ¼æ•°æ®
                        c = cell.text
                        row_content.append(c)
                    table_list.append(row_content)
                df_table = pd.DataFrame(table_list, columns=table_list[0])
                df_table.drop_duplicates(inplace=True)
                df_table.to_excel(file_dir.replace('.docx', 'è¡¨æ ¼_%d.xlsx' % (ind)), index=0)
    except:
        from pdf2docx import Converter
        import docx2pdf
        pdf_file = file_name.replace('.docx','.pdf')
        docx2pdf.convert(file_name,pdf_file)
        cv = Converter(pdf_file)
        new_name = filename.replace('.docx', '_è½¬.docx')
        cv.convert(new_name)
        cv.close()
        doc = docx.Document(new_name)

        all_tables_list = doc.tables
        # print(all_tables_list)
        if all_tables_list:
            for ind, all_table in enumerate(all_tables_list):
                table_list = []
                for row in all_table.rows:  # æŒ‰è¡Œè¯»å–
                    row_content = []
                    for cell in row.cells:  # è¯»å–æ¯ä¸ªå•å…ƒæ ¼æ•°æ®
                        c = cell.text
                        row_content.append(c)
                    table_list.append(row_content)
                df_table = pd.DataFrame(table_list, columns=table_list[0])
                df_table.drop_duplicates(inplace=True)
                df_table.to_excel(file_dir.replace('.docx', 'è¡¨æ ¼_%d.xlsx' % (ind)), index=0)
        os.remove(pdf_file)
        os.remove(new_name)

```

## ä¸å­˜åœ¨ç›®å½•åˆ™åˆ›å»º


```python
def is_dir(dir):
    if not os.path.exists(dir):
        os.mkdir(dir)
        # logger.info('åˆ›å»ºç›®å½•%s'%dir)
        print('åˆ›å»ºç›®å½•%s'%dir)
```

## æµ‹è¯•ç¤ºä¾‹


```python
if __name__ == '__main__':

    data_dir = os.path.join(root_dir, 'æ•°æ®/æµ‹è¯•ç›®å½•')
    file_name = os.path.join(data_dir,'xx.docx')
    read_docx(file_name)
```

## è¡¥å……customè„šæœ¬


```python
# -*- coding:utf-8 -*-


import time
import math
import os
import cn2an
import numpy as np
import regex as re


# æ—¶é—´å‡½æ•° æš‚æ—¶ä¸ç”¨
def timeSince(since):
    now = time.time()
    s = now - since
    m = math.floor(s / 60)
    s -= m * 60
    ms = (m*60+s)*1000
    return '%dm %ds / %dms' % (m, s,ms)
'''è®¡ç®—å½“å‰å‡½æ•°è¿è¡Œæ—¶é—´'''
def run_time(func):
    def wrapper(*args, **kw):
        local_time = time.time()
        res = func(*args, **kw)
        print('current Function [%s] run time is %.6f' % (func.__name__, time.time() - local_time))
        return res
    return wrapper
'''æ ¼å¼åŒ–è§„èŒƒæ•°æ®'''
def get_context(text):  # è·å–è§„èŒƒå†…å®¹å’Œæ¡ç›®ï¼ˆè§„èŒƒæ–‡æ¡£æ ¼å¼æ­£ç¡®ï¼‰
    # è¾“å…¥ä¸ºè§„èŒƒå†…å®¹  å¿…é¡»å­˜åœ¨å®ä½“

    # \u2028\u2029  æ®µåˆ†éš”ç¬¦ï¼Œè‚‰çœ¼æ˜¯æ— æ³•å¯Ÿè§‰çš„
    text = text.replace('\u2002', '').replace('\u00A0','').replace('\u3000', '').replace('\ue003','').replace('\ue5e5','').strip()
    text = text.replace('ï¼š',':')
    text = re.sub('\s+', '', text)  # ä¸Šé¢ä¸¤ä¸ªå…¨æ˜¯å»é™¤ç©ºç™½ç¬¦
    text = re.sub('<.+/>\n','',text)  # ç‰¹å®šæ ¼å¼
    text = re.sub("<img.+>", "", text)  # ç‰¹å®šæ ¼å¼
    text = text.replace('ï¼', '.')  # é˜²æ­¢åºå·æœ‰ä¸­æ–‡æ ‡ç‚¹
    if not text:
        return '','',''
    numstring = re.compile("[^A-Z^a-z^\s^\u4e00-\u9fa5]*").findall(text)[0].strip().replace('ã€', '.').replace('ï¼Œ','.')  # è·å–æ¡ç›®
    post_text = re.compile("[^A-Z^a-z^\s^\u4e00-\u9fa5]*(.+)").findall(text)[0].strip()  # è·å–é™¤æ¡ç›®å¤–çš„æ–‡æœ¬
    return text, numstring, post_text

'''æ ¼å¼åŒ–æ–‡æœ¬ï¼ˆé‡è¦ï¼‰'''
def format_text(text):
    '''
    :param text: å„ç§ç±»å‹çš„æ–‡æœ¬
    :return: æ ¼å¼åŒ–åçš„æ–‡æœ¬ï¼Œå»é™¤+æ›¿æ¢ç»Ÿä¸€æ ‡ç‚¹ç¬¦å·
    '''
    text = text.replace('\u2002', '').replace('\u00A0','').replace('\u3000', '').replace('\ue003','').replace('\ue5e5','').strip()
    text = text.replace('ã€','').replace('ã€‘','').replace('\t','').replace('â˜…','').replace('?','').replace('\\N','')
    # text = text.replace('ï¼š', ':').replace('ï¼ˆ','(').replace('ï¼‰',')')
    # text = text.replace('ï¼…','%').replace('ï¹ª','%')
    text = re.sub('\s+','',text)
    text = re.sub('<.+/>\n','',text)  # ç‰¹å®šæ ¼å¼
    text = re.sub("<img.+>", "", text)  # ç‰¹å®šæ ¼å¼
    return text

'''ä¸­æ–‡æ•°å­—è½¬é˜¿æ‹‰ä¼¯æ•°å­—'''
def num_transfor(text):
    '''
    :param text:
    :return:
    '''
    num_list = ['ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹','å']
    filter_list = ['ã€‡','å£¹','å¹º','è´°','å','è‚†','ä¼','é™†','æŸ’','æŒ','ç–','æ‹¾','ç™¾','ä½°','åƒ','ä»Ÿ','ä¸‡','äº¿']
    for i in filter_list:
        if i in text:
            return text
    return cn2an.transform(text, "cn2an")

'''åˆ‡å‰²å¥å­ï¼Œé€šè¿‡å¸¸è§åˆ†å‰²æ ‡ç‚¹'''
def cut_sentences_v1(sent):
    """
    the first rank of sentence cut
    """
    sent = re.sub('([ã€‚ï¼ï¼Ÿ\?])([^â€â€™])', r"\1\n\2", sent)  # å•å­—ç¬¦æ–­å¥ç¬¦
    sent = re.sub('(\.{6})([^â€â€™])', r"\1\n\2", sent)  # è‹±æ–‡çœç•¥å·
    sent = re.sub('(\â€¦{2})([^â€â€™])', r"\1\n\2", sent)  # ä¸­æ–‡çœç•¥å·
    sent = re.sub('([ã€‚ï¼ï¼Ÿ\?][â€â€™])([^ï¼Œã€‚ï¼ï¼Ÿ\?])', r"\1\n\2", sent)
    sent = re.sub('([ï¼›;])([^â€â€™])', r"\1\n\2", sent)

    # å¦‚æœåŒå¼•å·å‰æœ‰ç»ˆæ­¢ç¬¦ï¼Œé‚£ä¹ˆåŒå¼•å·æ‰æ˜¯å¥å­çš„ç»ˆç‚¹ï¼ŒæŠŠåˆ†å¥ç¬¦\næ”¾åˆ°åŒå¼•å·å
    return sent.split("\n")

def cut_sentences_v2(sent):
    """
    the second rank of spilt sentence, split 'ï¼›' | ';'
    """
    sent = re.sub('([ï¼›;])([^â€â€™])', r"\1\n\2", sent)
    return sent.split("\n")

```

## bugæ³¨æ„

* docè½¬docxæ—¶,è¦è®¾ç½®windowsè¯»å–doc/docxé»˜è®¤è½¯ä»¶ä¸ºå¾®è½¯word


## å‚è€ƒ
* [Tika](https://www.geeksforgeeks.org/parsing-pdfs-in-python-with-tika/)
* [python-docx](https://python-docx.readthedocs.io/en/latest/)
* [Pythonæ“ä½œPDFå…¨æ€»ç»“ pdfplumber&PyPDF2](https://zhuanlan.zhihu.com/p/344384506)
* [æ•°æ®è·å–pythonè¯»å–docxæ–‡æ¡£ï¼ˆä¸Šï¼‰](https://developer.aliyun.com/article/1091248?spm=5176.26934562.main.2.4a7c1934m2ZD)
* [æ•°æ®è·å–pythonè¯»å–docxæ–‡æ¡£ï¼ˆä¸‹ï¼‰](https://developer.aliyun.com/article/1091250?spm=5176.26934562.main.1.4a7c1934m2ZDZp)